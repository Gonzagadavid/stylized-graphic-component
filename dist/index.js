"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=t(e);class r extends e.Component{constructor(){super(),this.canvasRef=e.createRef(),this.legendCreate=this.legendCreate.bind(this),this.drawbackgound=this.drawbackgound.bind(this),this.drawBars=this.drawBars.bind(this),this.clearCanvas=this.clearCanvas.bind(this)}componentDidMount(){this.drawbackgound()}componentDidUpdate(){this.clearCanvas(),this.drawbackgound()}clearCanvas(){const e=this.canvasRef.current;e.getContext("2d").clearRect(0,0,e.width,e.height)}drawbackgound(){const{style:{widthGraph:e="1000",heightGraph:t="500",lineColor:o="black",fontSizeBackground:r="10",widthLine:a="1",fontBackground:n="monospace",percentSide:l="left"},maxPercent:i="100%"}=this.props,c="right"===l?e-4*r:10,d="70%"===i?8:"50%"===i?6:11,s=this.canvasRef.current.getContext("2d"),h=t/(d+1);let f=t-h,g=0;Array(d).fill(0).forEach((()=>{s.beginPath(),s.strokeStyle=o,s.lineWidth=a,s.moveTo(0,f),s.lineTo(e,f),s.stroke(),s.closePath(),s.fillStyle=o,s.font=`${r}px ${n}`,s.fillText(`${g}%`,c,f-2*a),f-=h,g+=10})),this.drawBars()}drawBars(){const{style:{widthBar:e="60",widthGraph:t="1000",heightGraph:o="500",fontSizeBar:r="15",fontBar:a="monospace",maxPercent:n="100%",fontColordifBar:l=!1,fontColor:i="black",topPercent:c=!1,withLegend:d=!1,baseName:s=!0},data:h={},colors:f=[]}=this.props,g=this.canvasRef.current,p=+r||20,b=a||"serif",u="70%"===n?8:"50%"===n?6:11,k=o/(u+1),w=g.getContext("2d"),C=Object.keys(h),y=Object.values(h).reduce(((e,t)=>e+ +t),0),m=o-o/(u+1),x=+e/2;let B=t/2-C.length/2*(+e+x);C.forEach(((t,o)=>{w.font=`${p}px ${b}`;const a=`${(100*+h[t]/y).toFixed(1)}%`,n=+h[t]*(10*k)/y;w.fillStyle=f[o]||"#aaa",w.fillRect(B,m,+e,-n),l&&(w.fillStyle=i||"black"),s&&w.fillText(t,B+e/8,m+p),c&&w.fillText(a,B+e/4,m-n-r/2),B+=x+ +e})),d&&this.legendCreate()}legendCreate(){const{style:{fontLegendSize:e="20",borderLegend:t="1",colorBorderLegend:o="black",colorLegend:r="white",fontLegend:a="monospace",widthGraph:n="1000",fontColorLegend:l="black",legendSide:i="right",legendVertical:c="atop",heightGraph:d="500"},data:s={},colors:h=[]}=this.props,f=this.canvasRef.current.getContext("2d"),g=Math.max(...Object.keys(s).map((e=>e.length)))*+e+5*+e,p=(+e+ +e/2)*Object.keys(s).length+2*+e,b="right"===i?n-(g+10):10,u="atop"===c?10:d-(p+10);f.fillStyle=o,f.fillRect(b-t,u-t,g+ +t,p+ +t),f.fillStyle=r,f.fillRect(b,u,g-+t,p-+t);const k=b+ +e;let w=u+ +e;h.forEach((t=>{f.fillStyle=t,f.fillRect(k,w,e,e),w+=+e+ +e/2}));const C=k+ +e+ +e/2;let y=u+(+e+ +e-e/6);const m=Object.keys(s);f.fillStyle=l,m.forEach((t=>{f.font=`${e}px ${a}`,f.fillText(t,C,y),y+=+e+ +e/2}))}render(){const{style:{widthGraph:e="1000",heightGraph:t="500",backgroundColor:r="white",widthBorder:a=1,borderColor:n="black"}=INITIAL_STATE}=this.props;return o.default.createElement("canvas",{className:"canvas",ref:this.canvasRef,width:e,height:t,style:{border:`${a}px solid ${n}`,backgroundColor:r}})}}r.defaultProps={data:{data1:6,data2:4},colors:["green","red"],maxPercent:"100%",style:{backgroundColor:"white",lineColor:"black",fontSizeBackground:"10",widthGraph:"1000",heightGraph:"500",widthBorder:"1",borderColor:"black",widthLine:"1",fontBackground:"monospace",percentSide:"left",widthBar:"60",fontSizeBar:"15",fontBar:"monospace",fontColordifBar:!1,fontColor:"black",topPercent:!1,baseName:!0,withLegend:!1,fontLegend:"monospace",fontLegendSize:"20",fontColorLegend:"black",colorLegend:"white",borderLegend:"1",colorBorderLegend:"black",legendSide:"right",legendVertical:"atop"}},exports.GraphicComponent=r;
